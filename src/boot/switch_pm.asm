; TODO: logic to switch to protected mode